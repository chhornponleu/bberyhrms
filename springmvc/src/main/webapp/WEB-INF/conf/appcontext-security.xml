<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:security="http://www.springframework.org/schema/security"
	xsi:schemaLocation="
		http://www.springframework.org/schema/beans 
		http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
		http://www.springframework.org/schema/security 
		http://www.springframework.org/schema/security/spring-security-3.2.xsd">

	<security:global-method-security pre-post-annotations="enabled" />
		
	<security:http use-expressions="true" auto-config="true" >

		<security:form-login 
			login-page="/auth/login" 
			login-processing-url="/auth/attemp"
			password-parameter="password"
			username-parameter="username"
			authentication-failure-url="/auth/login?failed=1"  />
		<security:logout 
			logout-url="/auth/logout" 
			logout-success-url="/" 
			invalidate-session="true"/>
		<security:session-management>
			<security:concurrency-control max-sessions="1" expired-url="/auth/expired"/>
		</security:session-management>
		
		<security:intercept-url pattern="/resources/**" 	access="permitAll()" />
		<security:intercept-url pattern="/auth/**" 			access="permitAll()"  />
		<security:intercept-url pattern="/**" 				access="isAuthenticated()"/>
	</security:http>	
	
	<security:authentication-manager erase-credentials="false">
		<security:authentication-provider ref="userAuthenticationProvider"/>
	</security:authentication-manager> 
	
	<bean id="userAuthenticationProvider" class="com.ponleu.springmvc.security.UserAuthenticationProvider"/>
</beans>